# 《记一次中间件导致的慢SQL排查过程》阅读

## 原文信息

作者：alchemystar

地址：https://www.cnblogs.com/alchemystar/p/13625226.html 

## 阅读目的

- 学习作者的分析流程
- 欣赏、学习作者画的图

## 文章要点

- 一个自研的`数据库分部分表中间件`，线上每天偶尔有几条 sql 有长达十几秒的超时。超时的 sql 是主键查询或主键更新。
- 业务中只有一部分流量走中间件，另一部分直接走数据库，超时的sql只会在连中间件的时候出现。

<img src="./img/01.jpg" alt="超时的sql只会在连中间件的时候出现"/>

- **排查第一步**：是否sql确实慢。“分析了日志，发现那段时间所有的sql在往后端数据执行的时候都只有0.5ms,非常的快。”**日志的重要性体现出来了，这里不仅在 APP 记录了查询耗时，插件/数据库也记录了 sql 耗时**

<img src="./img/02.jpg" alt="是否sql确实慢"/>

- **排查第一步**：寻找超时规律。
